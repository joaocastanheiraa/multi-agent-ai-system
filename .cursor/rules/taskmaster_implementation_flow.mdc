---
description: 
globs: 
alwaysApply: true
---
# ğŸ§  Fluxo de ImplementaÃ§Ã£o Inteligente e Direcionado

**REGRA CRÃTICA**: Este fluxo OBRIGATÃ“RIO transforma implementaÃ§Ã£o caÃ³tica em execuÃ§Ã£o profissional nÃ­vel enterprise. NUNCA implemente sem seguir TODAS as fases.

## ğŸ¯ **Objetivos e BenefÃ­cios Garantidos**

- ğŸš€ **+50% Velocidade**: Elimina retrabalho atravÃ©s de planejamento inteligente
- ğŸ’ **+90% Qualidade**: DecisÃµes baseadas em research e contexto completo  
- ğŸ¯ **Foco Laser**: Zero implementaÃ§Ãµes desnecessÃ¡rias ou ambÃ­guas
- ğŸ”„ **Zero Loops**: Sistema de validaÃ§Ã£o previne ciclos infinitos
- ğŸ§  **InteligÃªncia Arquitetural**: Contexto completo antes de qualquer cÃ³digo

---

## ğŸ”¥ **FASES OBRIGATÃ“RIAS (5 FASES + 5 GATES)**

### **ğŸ” FASE 0: ANÃLISE CONTEXTUAL PROFUNDA**
**GATE 1**: Contexto arquitetural completo validado

**ğŸ¯ MCP Tool**: `research`
```
research(
  query="AnÃ¡lise da arquitetura atual, padrÃµes existentes que devem ser seguidos e contexto do sistema multi-agente", 
  includeProjectTree=true, 
  filePaths="agents/,docs/,knowledge_base_source/",
  detailLevel="high",
  saveFile=true
)
```

**ğŸ¯ CLI Alternativo**: 
```bash
task-master research "AnÃ¡lise da arquitetura atual e padrÃµes existentes" --tree --files="agents/,docs/,knowledge_base_source/" --detail=high --save-file
```

**âœ… CHECKPOINT 1**: VocÃª DEVE entender completamente:
- Arquitetura atual do sistema multi-agente
- PadrÃµes existentes que DEVEM ser seguidos  
- DomÃ­nios, agentes e sub-agentes relacionados
- DependÃªncias e integraÃ§Ãµes crÃ­ticas

---

### **ğŸ“ FASE 1: PRD INTELIGENTE E CONTEXTUALIZADO**
**GATE 2**: PRD completo baseado em anÃ¡lise contextual

**ğŸ¯ AÃ§Ã£o**: Criar PRD em `scripts/PRD.txt` usando template `.taskmaster/templates/example_prd.txt`

**ğŸ“‹ TEMPLATE APRIMORADO**: O PRD DEVE incluir:
- **Contexto Real**: Baseado na Fase 0 de anÃ¡lise
- **DomÃ­nios Impactados**: Quais partes do sistema multi-agente
- **Agentes Relacionados**: Que agentes serÃ£o afetados
- **IntegraÃ§Ãµes**: Com sistemas existentes
- **PadrÃµes ObrigatÃ³rios**: Que devem ser seguidos
- **Arquitetura TÃ©cnica**: Alinhada com sistema atual
- **Roadmap LÃ³gico**: DependÃªncias e sequÃªncia de desenvolvimento

**âœ… CHECKPOINT 2**: PRD DEVE estar 100% alinhado com:
- Arquitetura descoberta na Fase 0
- PadrÃµes existentes do sistema
- Necessidades reais vs. implementaÃ§Ã£o desnecessÃ¡ria

---

### **ğŸ¤– FASE 2: GERAÃ‡ÃƒO INTELIGENTE DE TAREFAS**
**GATE 3**: Tarefas geradas com contexto completo

**ğŸ¯ MCP Tool**: `parse_prd`
```
parse_prd(
  input="scripts/PRD.txt",
  force=true
)
```

**ğŸ¯ CLI Alternativo**: 
```bash
task-master parse-prd scripts/PRD.txt --force
```

**âœ… CHECKPOINT 3**: Tarefas DEVEM refletir:
- Todos os requisitos do PRD contextualizado
- Alinhamento com arquitetura existente  
- DependÃªncias lÃ³gicas corretas
- Escopo realista e implementÃ¡vel

---

### **ğŸ”¬ FASE 3: ANÃLISE DE COMPLEXIDADE AVANÃ‡ADA**
**GATE 4**: Complexidade mapeada com research

**ğŸ¯ MCP Tool**: `analyze_project_complexity`
```
analyze_project_complexity(
  research=true,
  tag="master"
)
```

**ğŸ¯ CLI Alternativo**: 
```bash
task-master analyze-complexity --research
```

**ğŸ“Š Verificar RelatÃ³rio**:
**ğŸ¯ MCP Tool**: `complexity_report`
```
complexity_report(tag="master")
```

**ğŸ¯ CLI Alternativo**: 
```bash
task-master complexity-report
```

**âœ… CHECKPOINT 4**: AnÃ¡lise DEVE identificar:
- Tarefas de alta complexidade (8-10) para breakdown  
- Dependencies crÃ­ticas entre tarefas
- Riscos tÃ©cnicos potenciais
- Estimativas realistas de esforÃ§o

---

### **ğŸ”§ FASE 4: EXPANSÃƒO INTELIGENTE DIRECIONADA**
**GATE 5**: Subtarefas otimizadas e contextualizadas

**ğŸ¯ MCP Tool**: `expand_all`
```
expand_all(
  research=true,
  force=true,
  prompt="Contexto da Fase 0: [resumo da anÃ¡lise] + PadrÃµes obrigatÃ³rios: [padrÃµes identificados]"
)
```

**ğŸ¯ CLI Alternativo**: 
```bash
task-master expand --all --research --force --prompt="Contexto + PadrÃµes"
```

**âœ… CHECKPOINT 5**: ExpansÃ£o DEVE garantir:
- Subtarefas alinhadas com padrÃµes descobertos
- Breakdown baseado em complexidade real
- Contexto arquitetural preservado
- ImplementaÃ§Ã£o direcionada e eficiente

---

### **ğŸš€ FASE 5: EXECUÃ‡ÃƒO DIRECIONADA E OTIMIZADA**
**Loop Inteligente**: Contexto preservado em cada iteraÃ§Ã£o

**ğŸ¯ MCP Tools Sequence**:
```
1. next_task() â†’ PrÃ³xima tarefa baseada em dependÃªncias
2. research(query="[contexto especÃ­fico da tarefa]", taskIds="[id]") â†’ Research contextualizado
3. update_subtask(id="X.Y", prompt="[descobertas + progresso]") â†’ Log iterativo  
4. set_task_status(id="X.Y", status="done") â†’ Marca conclusÃ£o
```

**ğŸ¯ CLI Alternativo**:
```bash
1. task-master next
2. task-master research "[contexto da tarefa]" --id="X.Y" --save-to="X.Y"
3. task-master update-subtask --id="X.Y" --prompt="[progresso]"
4. task-master set-status --id="X.Y" --status=done
```

---

## ğŸ›¡ï¸ **SISTEMA DE PREVENÃ‡ÃƒO DE LOOPS E RECOVERY**

### **ğŸ” DetecÃ§Ã£o AutomÃ¡tica de Problemas**
- **Loop Infinito**: Mesma tarefa > 3 iteraÃ§Ãµes sem progresso
- **Deriva de Contexto**: ImplementaÃ§Ã£o divergindo do PRD
- **Quebra de PadrÃµes**: CÃ³digo fora dos padrÃµes descobertos
- **DependÃªncias Quebradas**: Circular ou inexistentes

### **ğŸ”§ Recovery AutomÃ¡tico**
**ğŸ¯ MCP Tools**: `update`, `update_task`
```
update(from="[id_problema]", prompt="CorreÃ§Ã£o baseada em [contexto_original]", research=true)
update_task(id="[id_especÃ­fico]", prompt="Realinhamento com PRD e padrÃµes", research=true)
```

**ğŸ¯ CLI Alternativo**:
```bash
task-master update --from="[id]" --prompt="CorreÃ§Ã£o" --research
task-master update-task --id="[id]" --prompt="Realinhamento" --research
```

---

## ğŸ“Š **MÃ‰TRICAS E KPIs OBRIGATÃ“RIOS**

### **ğŸ¯ MÃ©tricas de EficÃ¡cia**
- **Velocidade**: Tempo mÃ©dio por tarefa vs baseline
- **Qualidade**: % de tarefas completadas sem retrabalho  
- **Direcionamento**: % de implementaÃ§Ãµes alinhadas com PRD
- **EficiÃªncia**: Ratio de cÃ³digo Ãºtil vs cÃ³digo descartado
- **Contexto**: % de decisÃµes baseadas em research

### **ğŸ“ˆ Tracking ContÃ­nuo**
- Checkpoint completions vs tempo
- Research usage vs qualidade de output
- Pattern compliance vs architectural debt
- Loop prevention efficiency vs time saved

---

## âš¡ **COMANDOS DE REFERÃŠNCIA RÃPIDA**

### **ğŸ¤– MCP Tools (PREFERIDOS)**
```
research(query="...", includeProjectTree=true, filePaths="...", detailLevel="high")
parse_prd(input="scripts/PRD.txt", force=true)
analyze_project_complexity(research=true)
complexity_report()
expand_all(research=true, force=true, prompt="...")
next_task()
update_subtask(id="X.Y", prompt="...", research=true)
set_task_status(id="X.Y", status="done")
update(from="X", prompt="...", research=true)
update_task(id="X", prompt="...", research=true)
```

### **ğŸ’» CLI Commands (FALLBACK)**
```bash
task-master research "[query]" --tree --files="..." --detail=high --save-file
task-master parse-prd scripts/PRD.txt --force  
task-master analyze-complexity --research
task-master complexity-report
task-master expand --all --research --force --prompt="..."
task-master next
task-master update-subtask --id="X.Y" --prompt="..." --research
task-master set-status --id="X.Y" --status=done
task-master update --from="X" --prompt="..." --research
task-master update-task --id="X" --prompt="..." --research
```

---

## ğŸ¯ **EXEMPLO DE FLUXO COMPLETO**

```
ğŸ” FASE 0: research(query="Sistema multi-agente atual", includeProjectTree=true, filePaths="agents/,docs/")
ğŸ“ FASE 1: Criar PRD baseado na anÃ¡lise â†‘ em scripts/PRD.txt  
ğŸ¤– FASE 2: parse_prd(input="scripts/PRD.txt", force=true)
ğŸ”¬ FASE 3: analyze_project_complexity(research=true) + complexity_report()
ğŸ”§ FASE 4: expand_all(research=true, force=true, prompt="Contexto da Fase 0")
ğŸš€ FASE 5: Loop â†’ next_task() â†’ research() â†’ code â†’ update_subtask() â†’ set_task_status()
```

---

## ğŸš¨ **ALERTAS CRÃTICOS**

- **âŒ NUNCA pule a Fase 0**: Contexto Ã© OBRIGATÃ“RIO
- **âŒ NUNCA implemente sem PRD**: Planning prevents poor performance  
- **âŒ NUNCA ignore os Gates**: ValidaÃ§Ã£o Ã© CRÃTICA
- **âŒ NUNCA implemente fora dos padrÃµes**: Consistency is king
- **âŒ NUNCA continue sem research**: Context drives quality

**âœ… LEMBRE-SE**: Este fluxo Ã© um investimento que paga dividendos massivos em velocidade, qualidade e manutenibilidade. Execute religiosamente.
